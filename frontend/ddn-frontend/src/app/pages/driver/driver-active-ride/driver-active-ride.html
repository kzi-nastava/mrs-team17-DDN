<div class="page">
  <h1>Driver â€“ Active Ride</h1>

  <div *ngIf="loading" style="padding: 14px;">Loading...</div>
  <div *ngIf="!loading && error" style="padding: 14px;">{{ error }}</div>
  <div *ngIf="!loading && !ride" class="wrap">
    <div class="card">
      <button class="btn" type="button" (click)="openFutureRides()">
        Open Future Rides
      </button>
    </div>
  </div>

  <div class="wrap" *ngIf="!loading && ride">
    <div class="card">
      <div class="kv">
        <div class="k">Pickup</div>
        <div class="v">{{ ride.startAddress }}</div>
      </div>

      <div class="kv">
        <div class="k">Destination</div>
        <div class="v">{{ ride.destinationAddress }}</div>
      </div>

      <div class="kv">
        <div class="k">Price</div>
        <div class="v">{{ ride.price }} RSD</div>
      </div>

      <div class="status">
        Status:
        <span class="badge">{{ statusText() }}</span>
      </div>

      <button class="btn" *ngIf="!finished" (click)="finishRide()" [disabled]="finishing || finished">
        Finish ride (paid)
      </button>

      <div class="success" *ngIf="finished">
        <div>{{ postFinishMessage || 'Ride finished.' }}</div>
        <button
          class="btn success-btn"
          type="button"
          (click)="continueAfterFinish()"
          [disabled]="!postFinishTarget"
        >
          {{
            postFinishTarget === 'future'
              ? 'Open Future Rides'
              : postFinishTarget === 'home'
                ? 'Back to Driver Home'
                : 'Preparing next step...'
          }}
        </button>
      </div>
    </div>
  </div>
</div>
