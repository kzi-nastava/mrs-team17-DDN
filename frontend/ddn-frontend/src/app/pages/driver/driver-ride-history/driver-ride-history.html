<!-- src/app/pages/driver/driver-ride-history/driver-ride-history.html -->
<div class="page">
  <h1>Driver – Ride History</h1>

  <div class="card-fixed">
    <div class="filter">
      <div class="field">
        <span>From:</span>
        <input type="date" [value]="from ?? ''" (change)="onFromChange($event)" />
      </div>

      <div class="field">
        <span>To:</span>
        <input type="date" [value]="to ?? ''" (change)="onToChange($event)" />
      </div>

      <button (click)="applyFilter()">Filter</button>
    </div>

    <div class="table-body">
      <table class="history-table">
        <colgroup>
          <col class="col-date" />
          <col class="col-route" />
          <col class="col-price" />
          <col class="col-status" />
        </colgroup>

        <thead>
          <tr>
            <th>Date</th>
            <th>Route</th>
            <th>Price</th>
            <th>Status</th>
          </tr>
        </thead>

        <tbody *ngIf="!loading && !error">
          <tr
            class="clickable"
            *ngFor="let ride of rides"
            (click)="openRideDetails(ride.rideId)"
          >
            <td>{{ formatDateOnly(ride.startedAt) }}</td>
            <td>{{ truncate(ride.startAddress + ' → ' + ride.endAddress) }}</td>
            <td>{{ ride.price }} RSD</td>
            <td
              [class.completed]="isCompleted(ride.status, ride.canceled)"
              [class.canceled]="isCanceled(ride.status, ride.canceled)"
            >
              {{ formatStatus(ride.status, ride.canceled) }}
            </td>
          </tr>

          <tr *ngIf="rides.length === 0" class="empty-row">
            <td colspan="4">No rides.</td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="loading" class="state-message">Loading...</div>
      <div *ngIf="!loading && error" class="state-message">{{ error }}</div>
    </div>
  </div>
</div>
